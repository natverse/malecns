test_that("soma side information", {
  bids=c(46439, 25552, 85088, 15602, 12232, 10273, 70557, 14782, 520531,
    519496, 43992, 12183, 62207, 21688, 14869, 115456, 65083, 14192,
    79407, 19816, 19309, 22524, 519865, 16274, 27893, 15433, 31388,
    32741, 68335, 151368, 97247, 10646, 10094, 10184, 10323, 67747,
    20029, 25433, 515440, 30967, 12943, 11280, 511821, 12155, 11719,
    524668, 520194, 10136, 16754, 11717, 12503, 10035, 10299, 123969,
    92227, 80910, 83493, 93257, 148968, 114733, 88493)
  bl=c("R", "R", "L", "L", "R", "L", "R", "L", NA, "L", "L", "L",
       "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L",
       "L", "L", "L", "L", "L", "L", "R", "L", "L", "R", "L", "R", "R",
       "L", "L", "R", "R", "L", "L", "R", "L", "R", "L", "R", "L", "R",
       "L", "R", "R", "R", "R", "R", "R", "R", "R", "R")

  expect_equal(mcns_soma_side(bids), bl)
  # turns out number 7 is missing a soma (although we know which side it must be ...)
  expect_equal(mcns_soma_side(bids[1:6], method = 'manual'), bl[1:6])
})
