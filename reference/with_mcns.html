<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Evaluate an expression after temporarily setting malevnc options — with_mcns • malecns</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluate an expression after temporarily setting malevnc options — with_mcns"><meta name="description" content="malecns is a thin wrapper around malevnc. This
  function temporarily changes the server/dataset options for the malevnc
  while running your expression.
choose_mcns swaps out the male vnc dataset for the male
  cns. This means that all functions from the malevnc package should
  target the male cns instead. It is recommended that you use the
  with_mcns function to do this temporarily unless you have no
  intention of using the male vnc dataset. To switch the default
  malecns dataset please see choose_mcns_dataset."><meta property="og:description" content="malecns is a thin wrapper around malevnc. This
  function temporarily changes the server/dataset options for the malevnc
  while running your expression.
choose_mcns swaps out the male vnc dataset for the male
  cns. This means that all functions from the malevnc package should
  target the male cns instead. It is recommended that you use the
  with_mcns function to do this temporarily unless you have no
  intention of using the male vnc dataset. To switch the default
  malecns dataset please see choose_mcns_dataset."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">malecns</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/flyconnectome/malecns/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Evaluate an expression after temporarily setting malevnc options</h1>
      <small class="dont-index">Source: <a href="https://github.com/flyconnectome/malecns/blob/master/R/urls.R" class="external-link"><code>R/urls.R</code></a></small>
      <div class="d-none name"><code>with_mcns.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>malecns</code> is a thin wrapper around <code>malevnc</code>. This
  function temporarily changes the server/dataset options for the malevnc
  while running your expression.</p>
<p><code>choose_mcns</code> swaps out the male vnc dataset for the male
  cns. This means that all functions from the <code>malevnc</code> package should
  target the male cns instead. It is recommended that you use the
  <code>with_mcns</code> function to do this temporarily unless you have no
  intention of using the male vnc dataset. <em>To switch the default
  malecns dataset please see <code>choose_mcns_dataset</code></em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">with_mcns</span><span class="op">(</span></span>
<span>  <span class="va">expr</span>,</span>
<span>  dataset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"malecns.dataset"</span>, default <span class="op">=</span> <span class="st">"male-cns:v0.9"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">choose_mcns</span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"malecns.dataset"</span>, default <span class="op">=</span> <span class="st">"male-cns:v0.9"</span><span class="op">)</span>,</span>
<span>  set <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_clio <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>An expression involving malecns/malevnc functions to evaluate
with the specified autosegmentation. .</p></dd>


<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>The name of the dataset as reported in Clio e.g. <code>CNS</code>,
<code>male-cns:v0.9</code> etc.</p></dd>


<dt id="arg-set">set<a class="anchor" aria-label="anchor" href="#arg-set"></a></dt>
<dd><p>Whether to set the relevant package options or just to return a
list of the required options.</p></dd>


<dt id="arg-use-clio">use_clio<a class="anchor" aria-label="anchor" href="#arg-use-clio"></a></dt>
<dd><p>Whether to use clio to list datasets (expert use only;
default of <code>use_clio=NA</code> should do the right thing).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that as of 11 Aug 2025 it also switches out the active dataset
  for the malecns package if you specify something different using the
  <code>dataset</code> argument. This is probably what people always expected and
  allows you to easily run the same expression for e.g. production vs
  snapshot malecns datasets.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other malecns-package:
<code><a href="choose_mcns_dataset.html">choose_mcns_dataset</a>()</code>,
<code><a href="dr_malecns.html">dr_malecns</a>()</code>,
<code><a href="malecns-package.html">malecns-package</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">with_mcns</span><span class="op">(</span><span class="fu">malevnc</span><span class="fu">::</span><span class="fu"><a href="https://natverse.org/malevnc/reference/manc_dvid_node.html" class="external-link">manc_dvid_node</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'clio'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># This should work for both clio and neuprint calls, here clio:</span></span></span>
<span class="r-in"><span><span class="co"># this body was typed after the v0.9 snapshot</span></span></span>
<span class="r-in"><span><span class="fu">with_mcns</span><span class="op">(</span><span class="fu"><a href="mcns_body_annotations.html">mcns_body_annotations</a></span><span class="op">(</span><span class="fl">194965</span><span class="op">)</span>, dataset <span class="op">=</span> <span class="st">"male-cns:v0.9"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bodyid celltype_predicted_nt celltype_predicted_nt_confidence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 194965         acetylcholine                         0.952291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   celltype_total_nt_predictions  consensus_nt flywire_type group instance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         22356 acetylcholine         Sm01 29457    Cm2_L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predicted_nt predicted_nt_confidence soma_side   status   superclass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 acetylcholine               0.9597166         L Reviewed ol_intrinsic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   total_nt_predictions type  auto</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   66  Cm2 FALSE</span>
<span class="r-in"><span><span class="fu">with_mcns</span><span class="op">(</span><span class="fu"><a href="mcns_body_annotations.html">mcns_body_annotations</a></span><span class="op">(</span><span class="fl">194965</span><span class="op">)</span>, dataset <span class="op">=</span> <span class="st">"CNS"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> switching CNS dataset from `male-cns:v0.9` to `CNS`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bodyid celltype_predicted_nt celltype_predicted_nt_confidence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 194965         acetylcholine                        0.9478553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   celltype_total_nt_predictions  consensus_nt flywire_type group instance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         22356 acetylcholine         Sm01 29457    Cm2_L</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    predicted_nt predicted_nt_confidence soma_side   status   superclass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 acetylcholine               0.9552417         L Reviewed ol_intrinsic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   total_nt_predictions type  user  auto</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   66  Cm2 bergs FALSE</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Jefferis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

